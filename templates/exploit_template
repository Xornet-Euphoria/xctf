from pwn import p64, u64, ELF, process, remote
from xlog import XLog


logger = XLog("EXPLOIT")


# you need filling this variables
PROMPT_CHAR = None
CREATE_NUM = None
EDIT_NUM = None
DELETE_NUM = None
SHOW_NUM = None


def select(s, sel, c=PROMPT_CHAR):
    if sel is None or c is None:
        logger.warning("please fill above variables")
        exit(-1)
    s.recvuntil(c)
    s.sendline(str(sel))


# heap commands
def create(s):
    select(s, CREATE_NUM)


def edit(s):
    select(s, EDIT_NUM)


def delete(s):
    select(s, DELETE_NUM)


def show(s):
    select(s, SHOW_NUM)


if __name__ == "__main__":
    elf = ELF("${elf}")
    libc = ELF("${libc}")
    free_hook_libc = libc.symbols["__free_hook"]
    malloc_hook_libc = libc.symbols["__malloc_hook"]
    system_libc = libc.symbols["system"]
    one_gadgets = ${one_gadgets}
    main_arena_top = ${main_arena_top}

    s = process(elf.path)
    # s = remote("${target}", ${port})

    s.interactive()
